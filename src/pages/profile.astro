---
import Layout from "@/layouts/Layout.astro";
import { ProfileScreen } from "@/components/ProfileScreen";

/**
 * Profile page - User preferences management
 * 
 * Protected route: requires authentication
 * In DEVENV mode, uses default user from middleware
 */

// Check authentication
if (!Astro.locals.user) {
  // Preserve intended destination for post-login redirect (US-014)
  const returnTo = encodeURIComponent(Astro.url.pathname + Astro.url.search);
  return Astro.redirect(`/?returnTo=${returnTo}`);
}

export const prerender = false;
---

<Layout title="Profile - VibeRide">
  <ProfileScreen client:load />
</Layout>
